// Main title animation | Tomáš Faikl | 5/10/2016 | http://talented.cz //
function setup(){var a;if(window.innerWidth<=1e3?(a=createCanvas(1e3,.8*window.innerHeight),a.parent("hlavicka-anim"),$("#hlavicka-anim").css("left",(window.innerWidth-$("#hlavicka-anim canvas").width())/2)):(a=createCanvas(window.innerWidth,.8*window.innerHeight),a.parent("hlavicka-anim")),frameRate(30),textFont("Righteous"),textAlign(CENTER,CENTER),colorMode(RGB,255,255,255,255),_string="TALENTED",textSize(190),main_color_hsb=[88,.75,1],main_color=hsb2rgb(main_color_hsb[0],main_color_hsb[1],main_color_hsb[2]),main_color=color(main_color[0],main_color[1],main_color[2]),moving_count=300,pixel_span=10,initialized=!1,hover=!1,time=0,time_set=0,main_colors[0]=main_color,_string.length>1)for(var b=360/(_string.length-1),c=main_color_hsb[0],d=1;d<_string.length;d++){c+=b,c%=360;var e=hsb2rgb(c,main_color_hsb[1],main_color_hsb[2]);main_colors[d]=color(e[0],e[1],e[2])}for(var f=100/(_string.length-1),g=255,d=0;d<_string.length;d++)grey_colors[d]=color(g),g-=f}function draw(){if(initialized){if(background(10,10,10),hover||1!=$("canvas:hover").length?hover&&0==$("canvas:hover").length&&(time_set=time,hover=!1):(time_set=time,hover=!0),hover)for(var c=0;c<moving_particles.length;c++){var m=moving_particles[c],n=createVector(mouseX,mouseY);n=centerizeVector(n),n.x=map(n.x,-width/2,width/2,-sqrt(2)/2,sqrt(2)/2),n.y=map(n.y,-height/2,height/2,-sqrt(2)/2,sqrt(2)/2),m.applyForce(n.mult(.3))}for(var c=0;c<moving_particles.length;c++){var m=moving_particles[c];n=m.pos.x>=width/2?createVector(.005*window.pageYOffset,0):createVector(-.005*window.pageYOffset,0),m.applyForce(n)}for(var c=0;c<moving_particles.length;c++){var m=moving_particles[c];m.update(),m.display()}for(var c=0;c<font_particles.length;c++){var m=font_particles[c];m.update(),m.display()}time++}else{background(0),fill(255),noStroke(),text(_string,width/2,height/2+20);for(var a=width/2-515,b=!0,c=0;c<_string.length;c++){var d=[];a:for(var e=a+pixel_span;e<width/2+515;e+=pixel_span)for(var f=!1,g=height/2-140;g<height/2+140;g+=pixel_span){a=e;var h=get(e,g);if(h[0]>0)b=!1,f=!0,d.push(createVector(e,g));else if(!f&&g>=height/2+140-pixel_span&&!b){b=!0;break a}}font_points[c]=d}for(var c=0;c<_string.length;c++)for(var i=font_points[c],j=0;j<i.length;j++){var k=i[j];font_particles.push(new FontParticle(k.x,k.y,c))}for(var j=0;j<moving_count;j++){var c=int(random(0,_string.length)),i=font_points[c],l=i[int(random(0,i.length))];moving_particles.push(new MovingParticle(l.x,l.y,c))}console.log("initialized!"),font_points=[],initialized=!0}}function centerizeVector(a){var b=createVector(width/2,height/2);return a=p5.Vector.sub(a,b)}function FontParticle(a,b,c){this.init_pos=createVector(a,b),this.pos=createVector(a,b),this.vel=createVector(0,0),this.acc=createVector(0,0),this.i=c,this.init_size=random(2,8),this.size=this.init_size,this.applyForce=function(a){this.acc.add(a)},this.update=function(){this.size=map(sin(time*Math.PI/40+this.init_size),-1,1,2,pixel_span/2),this.vel.add(this.acc.limit(.1)),this.acc.mult(0),this.pos.add(this.vel)},this.display=function(){var c,a=hover?main_colors[this.i]:grey_colors[this.i],b=hover?grey_colors[this.i]:main_colors[this.i];c=0!=time_set?lerpColor(b,a,norm(time-time_set,0,25)):grey_colors[this.i],noStroke(),fill(c),ellipse(this.pos.x,this.pos.y,2*this.size,2*this.size)}}function MovingParticle(a,b,c){this.init_coord=createVector(a,b),this.pos=createVector(a,b),this.vel=createVector(random(-2,2),random(-6,2)),this.acc=createVector(0,0),this.i=c,this.size=random(2,3),this.max_vel=10/this.size,this.lifespan=random(150,160),this.lifetime=0,this.opacity=255,this.applyForce=function(a){this.acc.add(a)},this.update=function(){this.opacity<=2&&(this.pos=this.init_coord.copy(),this.vel=createVector(random(-2,2),random(-6,2)),this.acc=createVector(0,0),this.lifetime=0,this.opacity=1),this.vel.add(this.acc).limit(this.max_vel),this.acc.mult(0),this.pos.add(this.vel),this.borders(),this.lifetime++,this.opacity=map(cos(this.lifetime*Math.PI/this.lifespan),-1,1,0,150)},this.display=function(){var c,a=hover?grey_colors[this.i]:main_colors[this.i],b=hover?main_colors[this.i]:grey_colors[this.i];c=0!=time_set?lerpColor(b,a,norm(time-time_set,0,25)):main_colors[this.i],c._array[3]=norm(this.opacity,0,255),noStroke(),fill(c),ellipse(this.pos.x,this.pos.y,2*this.size,2*this.size)},this.borders=function(){this.pos.x<0?this.pos.x+=width:this.pos.x>width&&(this.pos.x-=width),this.pos.y<0?this.pos.y+=height:this.pos.y>height&&(this.pos.y-=height)}}var _string,main_color,main_color_hsb,moving_count,pixel_span,grey_colors=[],main_colors=[],font_particles=[],moving_particles=[],font_points=[],initialized,hover,time,time_set;$(window).resize(function(){$("#hlavicka-anim").css("left",(window.innerWidth-$("#hlavicka-anim canvas").width())/2),$("#hlavicka-anim").css("top",.5*(.8*window.innerHeight-$("#hlavicka-anim canvas").height()))});